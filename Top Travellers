-- LeetCode 1407: Top Travellers
-- Calculate total travelled distance per user
-- Include users with no rides (distance = 0)
-- Sort by travelled_distance DESC, name ASC

SELECT
    u.name,
    IFNULL(SUM(r.distance), 0) AS travelled_distance
FROM Users u
LEFT JOIN Rides r
    ON u.id = r.user_id
GROUP BY u.id, u.name
ORDER BY travelled_distance DESC, u.name ASC;
